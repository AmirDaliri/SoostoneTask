name: CI

on:
  push:
    branches:
      - main

jobs:
  build-and-test:
    runs-on: macos-latest

    strategy:
      matrix:
        configuration: [Debug, Release]

    steps:
    - uses: actions/checkout@v2

    - name: Set up Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: '13.2.1' # Specify your Xcode version here

    - name: List available simulators (for debugging)
      run: xcrun simctl list devices

    - name: Build
      run: xcodebuild build -project SoostoneTask.xcodeproj -scheme SoostoneTask -sdk iphonesimulator -configuration ${{ matrix.configuration }}

    - name: Test
      run: xcodebuild test -project SoostoneTask.xcodeproj -scheme SoostoneTask -sdk iphonesimulator -configuration ${{ matrix.configuration }} -destination 'platform=iOS Simulator,name=iPhone 8,OS=15.2'
